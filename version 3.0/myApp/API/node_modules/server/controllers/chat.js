const { v4: uuidv4 } = require('uuid');

class Chat {
  constructor() {
    
    this.chatProposals = [];
    this.chatsMessages = new Map();
    this.messageCallback = null;
  }


  sendMessage(message) 
  {
      let chatMessage = {
        id: message.key,
        originID: message.user,
        targetID: 'UserB',
        body: message.message,
        state: 'sended',
      };
      this.chatsMessages.set(0,chatMessage);

      return true;
  }

  getMessage() 
  {
    let message = this.chatsMessages.get(0);
    
    if (message.id.replace(/"/g, '') !== this.keyMessage.token)
    {
      console.log("Falla en seguridad Token");
      return null;
      
  } else {
      return message;
    }
  }

  generateToken() 
  {
      this.keyMessage = {
       
        token: uuidv4()
       
      };
      return this.keyMessage;
  }

}

module.exports = { Chat };
